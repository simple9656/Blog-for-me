[{"title":"Hello World","url":"/2025/12/26/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n"},{"title":"miscç¬”è®°ï¼ˆå¯èƒ½ä¸æ­£ç¡®ç‰ˆï¼‰","url":"/2025/12/18/misc%E5%90%84%E7%A7%8D%E9%A2%98%E5%9E%8B%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/","content":"miscå„ç§é¢˜å‹æ€è·¯æ€»ç»“1.ç­¾åˆ°é¢˜é‡åˆ°ç­¾åˆ°é¢˜éš¾åº¦çš„é¢˜ç›®ã€‚é¦–å…ˆå…ˆçœ‹çœ‹é¢˜å¹²æœ‰æ²¡æœ‰ç»™å‡ºflagçš„çº¿ç´¢ï¼Œå¦‚æœç»™çš„æ˜¯ç½‘é¡µï¼Œç›´æ¥f12æˆ–è€…ctrl+uå…ˆæŸ¥çœ‹æºä»£ç ï¼Œé€šè¿‡ctrl+fæŸ¥æ‰¾flagæˆ–è€…æ˜¯ç±»ä¼¼moectf{}ç­‰å„å¤§å¹³å°è¦æ±‚çš„ç»“æ„ã€‚å¦‚æœç»™çš„æ˜¯å›¾ç‰‡ï¼Œç›´æ¥ç”¨010 editor æ‰“å¼€çœ‹çœ‹æ–‡ä»¶å¤´å’Œæ–‡ä»¶å°¾ï¼ŒæŸ¥æ‰¾flag,å½“ç„¶è¿™åªæ˜¯ç­¾åˆ°é¢˜çš„éš¾åº¦ã€‚\n2.éšå†™ï¼š(1)æœ‰äº›å›¾ç‰‡å¯èƒ½é•¿å®½è®¾ç½®çš„å¤ªå°ï¼Œæ”¹ä¸‹å¤§å°å°±è¡Œï¼Œå³ä¸ºé•¿å®½ä¿®å¤ï¼Œä½†è¦ç¬¦åˆcrcæ ‡å‡†ï¼Œæœ‰äº›æ–‡ä»¶çš„æ–‡ä»¶å¤´æˆ–è€…æ–‡ä»¶å°¾è¢«ç¯¡æ”¹ï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¿®å¤ã€‚\n(2)lsbéšå†™ï¼šç”¨stegsolveæŸ¥çœ‹å„ä¸ªé€šé“ï¼ŒæŸ¥çœ‹æœ‰æ²¡æœ‰flagçš„ä¿¡æ¯æˆ–è€…æœ‰æ²¡æœ‰å…¶ä»–æ–‡ä»¶çš„æ–‡ä»¶å¤´ç‰¹å¾ã€‚\n(3)binwalkçš„ä½¿ç”¨ï¼šé¦–å…ˆä¸€èˆ¬ä¸ºäº†æ–¹ä¾¿ï¼Œä¸€èˆ¬ä¼šåœ¨é¢˜ç›®ç›®å½•ä¸‹ç›´æ¥æ‰“å¼€cmd å…ˆè¾“å…¥æŒ‡ä»¤ python -m binwalk xxx.pngæŸ¥çœ‹å›¾ç‰‡æ˜¯å¦æœ‰éšå†™äº†æ–‡ä»¶å³ä¸ºuncompressedçš„éƒ¨åˆ†ä¼šç»™ä½ nameå¦‚æœæœ‰ï¼Œä¸‹ä¸€æ­¥å°±è¾“å…¥python -m binwalk -e xxx.pngå³å¯å¾—åˆ°æƒ³è¦çš„flagæ–‡ä»¶ã€‚binwalkæ— æ³•åˆ†ç¦»çš„æƒ…å†µï¼Œåœ¨ kaliè¾“å…¥dd if&#x3D;misc14.jpg of&#x3D;1.jpg skip&#x3D;2103 bs&#x3D;1\n(4)gifæ–‡ä»¶ï¼šæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºåŠ¨å›¾æ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€å¸§å¸§çš„å›¾ç‰‡æ‹¼æ¥è€Œæˆï¼Œä¸€èˆ¬ä¼šå°†flagå›¾ç‰‡è—åœ¨æŸä¸€å¸§é‡Œï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠgifæ¯ä¸€å¸§çš„å›¾ç‰‡æŠ½ç¦»å¼€æ¥ï¼Œå¯ä»¥ç›´æ¥ç”¨WPSå›¾ç‰‡æ‰“å¼€ï¼Œä¾‹å¦‚buuctfçš„â€œé‡‘ä¸‰èƒ–â€è¿™ä¸€é¢˜ï¼Œæ˜¯ä¸æ˜¯æœ‰æŸå‡ å¸§é—ªè¿‡äº†flag,è¿™æ—¶å€™ä½¿ç”¨wpså›¾ç‰‡çš„â€œä¿å­˜å…¨éƒ¨å¸§â€çš„åŠŸèƒ½ï¼Œå³å¯æ‰¾åˆ°flagã€‚æˆ–è€…ä¸‹è½½é™„ä»¶ï¼Œæœ‰ä¸€ä¸ªgifåŠ¨ç”»ï¼Œflagè—åœ¨åŠ¨ç”»é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ StegSolve è½¯ä»¶çš„ Frame Browser æ¨¡å¼ï¼Œé€å¸§è¯»å–è·å¾—flagã€‚\n(5)å›¾ç‰‡éšå†™å¥½ç”¨ï¼šzsteg(kali),ç›´æ¥å¯ä»¥è§£å†³lsbéšå†™å’Œ010çš„æŸ¥çœ‹,[ä¸‹è½½å›¾ç‰‡ä½¿ç”¨zsteg misc17.pngå‘½ä»¤ï¼Œåœ¨ä½¿ç”¨zsteg -e extradata:0 misc17.png &gt;1.txtï¼Œæœ€åä½¿ç”¨binwalk -e 1.txtåˆ†ç¦»å¾—åˆ°flag]å¸¸è§å¥—è·¯\nimport zlib\nwith open(â€˜extracted_data1.zlibâ€™, â€˜rbâ€™) as f:    data1 &#x3D; f.read()\ntry:    decompressed_data1 &#x3D; zlib.decompress(data1)    print(â€œâ€” Data from extracted_data1.zlib â€”â€œ)    print(decompressed_data1)    with open(â€˜unpacked1.datâ€™, â€˜wbâ€™) as f_out:        f_out.write(decompressed_data1)except Exception as e:    print(fâ€Failed to decompress data1: {e}â€)\nprint(â€œ\\nâ€ + â€œ&#x3D;â€*50 + â€œ\\nâ€)\nwith open(â€˜extracted_data2.zlibâ€™, â€˜rbâ€™) as f:    data2 &#x3D; f.read()\ntry:    decompressed_data2 &#x3D; zlib.decompress(data2)    print(â€œâ€” Data from extracted_data2.zlib â€”â€œ)    print(decompressed_data2)\nwith open(&#39;unpacked2.dat&#39;, &#39;wb&#39;) as f_out:\n    f_out.write(decompressed_data2)\n\nexcept Exception as e:    print(fâ€Failed to decompress data2: {e}â€)\n\nyolo@Yolo:~&#x2F;Desktop&#x2F;timu$ python tiqu.pyâ€” Data from extracted_data1.zlib â€”bâ€™PK\\x03\\x04\\n\\x00\\x00\\x00\\x00\\x00\\xc1|\\r[R0G\\xee \\x00\\x00\\x00 \\x00\\x00\\x00\\n\\x00\\x00\\x00secret.bin\\x15\\t\\x02\\x15VNETTAVCEPT@P\\x12E\\U\\x17P\\x12FUW\\x17QCD\\x01PK\\x03\\x04\\x14\\x00\\x00\\x00\\x08\\x00\\x1b}\\r[\\xf8g\\x00\\xb5_\\x00\\x00\\x00\\xc3\\x00\\x00\\x00\\x08\\x00\\x00\\x00hint.txt]M1\\n\\x800\\x0c\\xfcz\\x1d\\x9c\\xac\\x82\\x88\\x9b\\x0fp\\x88\\xa0\\x83\\xa2(\\xf8\\x97\\xd0\\x88N\\xfd\\x82\\xb1\\xa5\\xb1\\x14\\xc2q\\xb9\\xdc]\\xae\\xb6\\xbe\\xe7\\xcal\\xc5\\x935\\xf6\\xd0\\xa8JT\\xda\\xee&#39;*&#96;â€\\x9c\\xc6\\x89\\xba\\x9e\\xf2\\xc5\\xac\\x83\\xf3\\x00c \\xca\\xd9\\xfe,#O\\xec\\xf4W\\xe9\\x8cW\\xdf O\\x13]\\xda\\x12&#x3D;(\\xf0\\x02PK\\x01\\x02?\\x00\\n\\x00\\x00\\x00\\x00\\x00\\xc1|\\r[R0G\\xee \\x00\\x00\\x00 \\x00\\x00\\x00\\n\\x00$\\x00\\x00\\x00\\x00\\x00\\x00\\x00 \\x00\\x00\\x00\\x00\\x00\\x00\\x00secret.bin\\n\\x00 \\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x18\\x00]\\xd3&#x3D;2%\\x0c\\xdc\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00PK\\x01\\x02?\\x00\\x14\\x00\\x00\\x00\\x08\\x00\\x1b}\\r[\\xf8g\\x00\\xb5\\x00\\x00\\x00\\xc3\\x00\\x00\\x00\\x08\\x00$\\x00\\x00\\x00\\x00\\x00\\x00\\x00 \\x00\\x00\\x00H\\x00\\x00\\x00hint.txt\\n\\x00 \\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x18\\x00\\xc1\\xebz\\x98%\\x0c\\xdc\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00PK\\x05\\x06\\x00\\x00\\x00\\x00\\x02\\x00\\x02\\x00\\xb6\\x00\\x00\\x00\\xcd\\x00\\x00\\x00\\x00\\x00â€™\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nFailed to decompress data2: Error -3 while decompressing data: invalid stored block lengthsyolo@Yolo:&#x2F;Desktop&#x2F;timu$ mv unpacked1.dat flag.zipyolo@Yolo:&#x2F;Desktop&#x2F;timu$ unzip flag.zipArchive:  flag.zip extracting: secret.bin\n  inflating: hint.txt\nfrom pathlib import Path\nè¯·å°†æ­¤å¤„æ›¿æ¢ä¸ºsecret.binæ–‡ä»¶çš„å®é™…è·¯å¾„\nsecret_bin_path &#x3D; Path(â€œC:\\Users\\21426\\Downloads\\_87.png-0.extracted\\6F7BF_FILES\\secret.binâ€)  # æˆ–è€…ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¦‚ Path(â€œD:&#x2F;path&#x2F;to&#x2F;secret.binâ€)\ndef xorkey(d, k):    k &#x3D; k.encode()    return bytes(b ^ k[i % len(k)] for i, b in enumerate(d))\ntry:    # è¯»å–æ–‡ä»¶æ•°æ®    data &#x3D; secret_bin_path.read_bytes()    print(â€œæˆåŠŸè¯»å–secret.binæ–‡ä»¶â€)\n# ç¬¬1æ­¥ï¼šæ–‡ä»¶åhexä½œå¯†é’¥ï¼ˆä¸å«æ‰©å±•åï¼‰\nfn_hex = &quot;3232353135345f6d6973632d504e475f4d4073743372&quot;  # &quot;225154_misc-PNG_M@st3r&quot; çš„åå…­è¿›åˆ¶\nprint(&quot;ç¬¬1æ­¥ç»“æœ:&quot;, xorkey(data, fn_hex))\n\n# ç¬¬2æ­¥ï¼šç”¨ &#39;secret&#39; ä½œä¸ºå¯†é’¥\nstep2 = xorkey(data, &quot;secret&quot;).decode()\nprint(&quot;ç¬¬2æ­¥ç»“æœ:&quot;, step2)\n\n# ç¬¬3æ­¥ï¼šhexè½¬ASCII\nif &quot;:&quot; in step2:\n    flag_hex = step2.split(&quot;:&quot;)[1]\n    print(&quot;ç¬¬3æ­¥ç»“æœ:&quot;, bytes.fromhex(flag_hex).decode())\nelse:\n    print(&quot;ç¬¬2æ­¥ç»“æœæ ¼å¼ä¸æ­£ç¡®ï¼Œæ— æ³•æå–flag&quot;)\n\nexcept FileNotFoundError:    print(fâ€é”™è¯¯ï¼šæ‰¾ä¸åˆ°æ–‡ä»¶ {secret_bin_path}â€)    print(â€œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®â€)except Exception as e:    print(fâ€å‘ç”Ÿé”™è¯¯ï¼š{e}â€)\n(7)curl:content length\n(8)steghide:æ”¯æŒjpgï¼Œbmpéšå†™txtæ–‡ä»¶\n(9)çœ‹åˆ°ä¸€ä¸ªzip åŠ å¯†æ–‡ä»¶ï¼š1.çœ‹æ˜¯ä¸æ˜¯ä¼ªåŠ å¯†  2.é¢˜ç›®ç»™å‡ºå·²çŸ¥ä¿¡æ¯ï¼Œå¯å°è¯•æš´åŠ›ç ´è§£ 3.é¢˜ç›®ç»™å‡ºæ©ç ï¼Œå¯å°è¯•æ©ç ç ´è§£ 3.é¢˜ç›®æœªç»™å‡ºå¯†ç ç›¸å…³æè¿°ï¼Œè¦è¯•è¯•å¤§æ¦‚ç‡æ˜¯æ˜æ–‡æ”»å‡»ï¼šç”¨bkcrackå°è¯•ç ´è§£ã€‚æœ‰æ˜æ–‡æ–‡ä»¶ç›´æ¥ç”¨.\n(10)ä¸€ç§å¾ˆæ–°å¥‡çš„åŠ å¯†æ–¹å¼ï¼šä¸ä½›è®ºç¦…(ä½›æ›°&#x2F;å¦‚æ˜¯æˆ‘é—»)è§£ç :flag{w0_fo_ci_Be1}ä½›æ›°ï¼šé®ç­‰è«³å‹èƒ½ç¤™çš¤è—å“†å¨‘æ¢µè¿¦ä¾„ç¾…å“†è¿¦æ¢µè€…æ¢µæ¥è˜‡æ¶…ä¾„å®¤å¯¦çœŸç¼½æœ‹èƒ½ã€‚å¥¢æ€›ä¿±é“æ€¯éƒ½è«³æ€–æ¢µå°¼æ€¯ä¸€ç½°å¿ƒç¼½è¬¹ç¼½è–©è‹¦å¥¢å¤¢æ€¯å¸æ¢µé æœ‹é™€è«³é™€ç©†è«³æ‰€å‘çŸ¥æ¶…ä¾„ä»¥è–©æ€¯æƒ³å¤·å¥¢é†¯æ•¸ç¾…æ€¯è«¸\n(11)flagå½¢å¼é‡Œåªæœ‰_æ²¡æœ‰-\n(12)osinté—®é¢˜ï¼šéœ€è¦é€šè¿‡æœç´¢å¼•æ“ä¾‹å¦‚è°·æ­Œç™¾åº¦\n(13)emojiæ–‡å­—è§£ç æœ‰åœ¨çº¿ç½‘ç«™ï¼Œè¦çŸ¥é“å¯†é’¥\n(14)æ¡å½¢ç ï¼šæœ‰åœ¨çº¿ç½‘ç«™\n(15)bpgæ–‡ä»¶ï¼šç”¨honeyviewæ‰“å¼€\n(16)binwalkä¸»è¦ç”¨æ¥åˆ†ç¦»æ–‡ä»¶é‡Œçš„å‹ç¼©åŒ…(åŒ…æ‹¬zlibï¼Œè¿™é‡Œé¢å¯èƒ½è—ä¸œè¥¿)ï¼Œforemostç”¨æ¥åˆ†ç¦»æ–‡ä»¶é‡Œçš„å›¾ç‰‡\n(17)idatéšå†™ï¼šåœ¨tweakpngä¸­åˆ idatä¸€ä¸ªä¸€ä¸ªåˆ ï¼Œåˆ å¯¹äº†å°±æœ‰å›¾åƒäº†\n(18)éš”ä½æå–ï¼šctÂ¹fâ€¦sâ€ hÂªoKwÂ°{!aeS6Â¥eT34fxa%4Ã8Ã¯fÂ«52â€¢8bâ€š1Âº7E4|2Td~7:2Ã¤eÃ±6ÃºfÃµ4129T8Ã±328Ã©0l}è§„å¾‹é¢˜\n(19)pdféšå†™ï¼šwbstegoçˆ†ç ´å°±è¡Œï¼Œä¼šæœ‰å…³ä¸æ‰çš„æƒ…å†µï¼Œç›´æ¥ctrl+shift+escä»»åŠ¡ç®¡ç†å™¨å¼ºè¡Œå…³é—­\n(20)Serpentè§£å¯†ï¼šSerpentæ˜¯snakeçš„å¦ä¸€ç§è¡¨ç¤ºï¼Œé¢˜ç›®ä¼šç»™ä½ éšè—çš„key,è¿™æ—¶å€™ç›´æ¥ç”¨åœ¨çº¿ç½‘ç«™å°±å¯ä»¥ï¼Œdecryptæ˜¯è§£å¯†\n(21)outguesséšå†™ï¼škali outguessç›´æ¥å‡º,ä¾‹å¦‚ï¼šoutguess -k abc -r mmm.jpg flag.txt.\n(22)å°¾éƒ¨ä¸€å †é•¿å¾—åƒbaseçš„ï¼Œç”¨010å¯¼å…¥åå…­è¿›åˆ¶ï¼Œå†æŠŠtxtå¯¼å‡ºï¼Œå‘ç°æ˜¯åæ ‡å½¢å¼ï¼Œè¿™æ—¶å€™è¦ç”¨ç”»å›¾è½¯ä»¶,å°†gnuplotTxt.txtæ”¾åˆ°gnuplot.exeçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå¯åŠ¨gnuplotï¼Œåœ¨å‘½ä»¤è¡Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯ç»˜å›¾ã€‚plot â€œgnuplotTxt.txtâ€\nè½¬åŒ–ä¸ºgnuplotèƒ½è¿è¡Œæ ¼å¼çš„è„šæœ¬\nwith open(â€˜result.txtâ€™, â€˜râ€™) as res:  # åæ ‡æ ¼å¼æ–‡ä»¶æ¯”å¦‚(7,7)    re &#x3D; res.read()    res.close()\nwith open(â€˜gnuplotTxt.txtâ€™, â€˜wâ€™) as gnup:   # å°†è½¬æ¢åçš„åæ ‡å†™å…¥gnuplotTxt.txt    re &#x3D; re.split()    tem &#x3D; â€˜â€™    for i in range(0, len(re)):        tem &#x3D; re[i]        tem &#x3D; tem.lstrip(â€˜(â€˜)        tem &#x3D; tem.rstrip(â€˜)â€™)        for j in range(0, len(tem)):            if tem[j] &#x3D;&#x3D; â€˜,â€™:                tem &#x3D; tem[:j] + â€˜ â€˜ + tem[j+1:]        gnup.write(tem + â€˜\\nâ€™)    gnup.close()\n(23)base64éšå†™è§£ç è„šæœ¬ï¼š\ndef get_base64_diff_value(s1, s2):    base64chars &#x3D; â€˜ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;â€˜    res &#x3D; 0    for i in xrange(len(s2)):        if s1[i] !&#x3D; s2[i]:            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))    return res\ndef solve_stego():    with open(â€˜E:&#x2F;abcc.txtâ€™, â€˜rbâ€™) as f:        file_lines &#x3D; f.readlines()        bin_str &#x3D; â€˜â€™        for line in file_lines:            steg_line &#x3D; line.replace(â€˜\\nâ€™, â€˜â€™)            norm_line &#x3D; line.replace(â€˜\\nâ€™, â€˜â€™).decode(â€˜base64â€™).encode(â€˜base64â€™).replace(â€˜\\nâ€™, â€˜â€™)            diff &#x3D; get_base64_diff_value(steg_line, norm_line)            print diff            pads_num &#x3D; steg_line.count(â€˜&#x3D;â€™)            if diff:                bin_str +&#x3D; bin(diff)[2:].zfill(pads_num * 2)            else:                bin_str +&#x3D; â€˜0â€™ * pads_num * 2            print goflag(bin_str)\ndef goflag(bin_str):    res_str &#x3D; â€˜â€™    for i in xrange(0, len(bin_str), 8):        res_str +&#x3D; chr(int(bin_str[i:i + 8], 2))    return res_str\nif name &#x3D;&#x3D; â€˜mainâ€˜:    solve_stego()\n(24)å¾—åˆ°hexä»£ç ï¼Œç°åœ¨txtæ–‡ä»¶é‡Œä¿å­˜,ç„¶åç”¨010æ–‡ä»¶-&gt;å¯¼å…¥åå…­è¿›åˆ¶\n(25)exiftool-kaliæ‰¾flagæŒ‡ä»¤ï¼šexiftool * | grep flag ,exifåœ¨æµé‡åˆ†æé‡Œæœ‰æ—¶å€™ä¹Ÿæ˜¯å…³é”®å­—\n(26)å­—é¢‘ç»Ÿè®¡è„šæœ¬ï¼Œé€‚ç”¨äºå¤§é‡æ— è§„å¾‹çš„æ–‡æœ¬ï¼ˆæˆ–è€…éšæ³¢é€æµï¼‰\n#Author: mochu7alphabet &#x3D; â€œabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- &#x3D;\\{\\}[]â€strings &#x3D; open(â€˜.&#x2F;flag.txtâ€™).read()\nresult &#x3D; {}for i in alphabet:\tcounts &#x3D; strings.count(i)\ti &#x3D; â€˜{0}â€™.format(i)\tresult[i] &#x3D; counts\nres &#x3D; sorted(result.items(),key&#x3D;lambda item:item[1],reverse&#x3D;True)for data in res:\tprint(data)\nfor i in res:\tflag &#x3D; str(i[0])\tprint(flag[0],end&#x3D;â€â€)\nimport collections\nfilename &#x3D; â€œè°å¤šè°å°‘ï¼Œä¸€ç®—ä¾¿çŸ¥.txtâ€\nä½¿ç”¨ with è¯­å¥è¯»å–æ–‡ä»¶å…¨éƒ¨å†…å®¹\nwith open(filename, â€˜râ€™, encoding&#x3D;â€™utf-8â€™) as file:    content &#x3D; file.read()\nâ€” 1. æå–å­—ç¬¦è¡¨ â€”\ncharacter_table &#x3D; sorted(list(set(content)))print(fâ€å­—ç¬¦è¡¨ (å…± {len(character_table)} ç§):â€)print(â€˜â€™.join(character_table))print(â€œ-â€œ * 30)\nâ€” 2. ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„ä¸ªæ•° â€”\nchar_counts &#x3D; collections.Counter(content)\nâ€” 3. æ‰“å°ç»“æœ (æŒ‰æ•°é‡ä»é«˜åˆ°ä½æ’åº) â€”\nprint(â€œç»Ÿè®¡ç»“æœ:â€)\nå®šä¹‰ç‰¹æ®Šç©ºç™½å­—ç¬¦çš„å¯è¯»æ€§è¡¨ç¤º\nspecial_char_map &#x3D; {    â€˜\\nâ€™: râ€™\\n (æ¢è¡Œ)â€™,    â€˜ â€˜:  â€˜  (ç©ºæ ¼)â€™,    â€˜\\tâ€™: râ€™\\t (åˆ¶è¡¨ç¬¦)â€™}\nfor char, count in char_counts.most_common():    display_char &#x3D; special_char_map.get(char, char)    print(fâ€{display_char}:{count}â€)\n(27)é¢œæ–‡å­—è§£ç -&gt;aaencodeè§£å¯†\n(28)zipfileè„šæœ¬ï¼š\nimport zipfile\nname &#x3D; â€˜0573â€™\nwhile True:\n  fz &#x3D; zipfile.ZipFile(name + â€˜.zipâ€™, â€˜râ€™)\n  fz.extractall(pwd&#x3D;bytes(name, â€˜utf-8â€™))\n  name &#x3D; fz.filelist[0].filename[0:4]\n  fz.close()\n(27)ookéšå†™ï¼šç”¨brainfuckç½‘ç«™è¿›è¡Œè§£å¯†\n(28)ä¿®æ”¹å›¾ç‰‡å°ºå¯¸ï¼Œå¯ä»¥ç”¨ç…§ç‰‡çš„åŠŸèƒ½\n(29)pycæ–‡ä»¶ï¼šç”¨pyç½‘ç«™åç¼–è¯‘\n(30)å›¾ç‰‡xorï¼šå°±æ˜¯photo1.png^photo2.pngï¼Œå°±æ˜¯å‡ ä¸ªé€šé“çš„ç¼–å·0æå–ä¸€ä¸‹ã€‚ç„¶åä½¿ç”¨StegSolveè‡ªå¸¦çš„Image Combinerè¿›è¡Œxorå¤„ç†ã€‚\næœ€ç»ˆä½¿ç”¨Alpha Plane0å’ŒGreen Plane0è¿›è¡Œå¼‚æˆ–çš„æ—¶å€™å¾—åˆ°Flagã€‚\n(31)snowéšå†™ï¼šsnow.exe -p â€œbrainfuckisgoooooodâ€ å’é›ª.txt\nâ€‹                            snow.exe -p â€œå¯†ç ï¼škeyâ€ å¿…é¡»æ˜¯txtæ–‡ä»¶ï¼ˆå…¶ä»–æ–‡ä»¶å¤åˆ¶ç²˜è´´åˆ°txtæ–‡ä»¶ä¸­ï¼‰  \n3.æµé‡åˆ†æï¼š(1)htttp:    http.request.method&#x3D;&#x3D;POSTè¿›è¡Œè¿‡æ»¤\n(2)æœ€ç®€å•çš„ä¸€ç±»ï¼šç›´æ¥ctrl+få¯»æ‰¾flag\n(3)å¦‚æœæœå®Œä¹‹åæ²¡æœ‰å‘ç°ä¿¡æ¯ï¼Œå…ˆçœ‹ç»Ÿè®¡é‡Œçš„åè®®åˆ†çº§ï¼Œçœ‹çœ‹å“ªä¸ªæµå æ¯”å¤šï¼Œç ”ç©¶å¯¹è±¡å°±æ˜¯é‚£ä¸ªæµ\n(4)è¿›è¡Œè¿½è¸ªæµæ“ä½œã€‚\n(5)è¿½è¸ªæµåï¼š1.å¦‚æœæœ‰base64ï¼Œå¯¼å‡ºï¼ˆæ³¨æ„åˆ ä¸€äº›æ¢è¡Œç¬¦å’Œè¿è¡Œæ—¶é—´ï¼‰\n(6)é—®åˆ°è´¦å·å’Œå¯†ç ï¼Œä¼˜å…ˆè€ƒè™‘httpæµï¼Œæ‰¾åˆ°ç±»ä¼¼loginçš„ç™»å½•è¯·æ±‚,æ‰¾åˆ°name,admin,passwordç­‰è¯è¯­\n(7)åœ¨æµé‡ä¸­è—å‹ç¼©åŒ…æ—¶ï¼Œå¯ä»¥ç›´æ¥ç”¨binwalkåˆ†ç¦»\n(8)èœåˆ€ï¼Œèœåˆ€ä¼ è¾“æ˜¯POST\nhttp.request.method&#x3D;&#x3D;â€POSTâ€\n(8)string xxx.pcap | grep {    å¯»æ‰¾flagçš„ä¸€ç§æ–¹å¼\nè¿™ç§ä¸€æ˜Ÿç®€å•æµé‡åŒ…ï¼Œå°±å…ˆçœ‹çœ‹æ˜¯ä¸æ˜¯å­˜åœ¨flagã€f14gã€f1agã€fl4gç­‰å­—ç¬¦ä¸²\nhttp contains â€œshellâ€æœç´¢webshell\n4.è·¯ç”±å™¨é—®é¢˜ï¼šæŸ¥çœ‹æ–‡ä»¶æ²¡æœ‰å‘ç°ä»€ä¹ˆç‰¹æ®Šä¿¡æ¯ï¼Œé¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤ºã€‚æˆ‘ä»¬å°è¯•å°†ç”¨æˆ·åï¼ˆUsernameï¼‰å’Œå¯†ç ï¼ˆPasswordï¼‰ä½œä¸ºflagå€¼æäº¤ï¼Œæœ€åç¡®è®¤ç”¨æˆ·åä¸ºflagå€¼ã€‚ï¼ˆå¦‚æœæ‰¾ä¸åˆ°Usernameã€Passwordï¼Œå¯ä»¥ä½¿ç”¨Ctrl+fæŸ¥æ‰¾ï¼‰ç”¨è½¯ä»¶routerpassview\n5.webshellé—®é¢˜ï¼šä½¿ç”¨æŸ¥æ€å·¥å…·Dç›¾ï¼Œæ‰«æï¼Œå¦‚æœæœ‰md5ï¼Œé‚£ä¹ˆmd5å°±æ˜¯flagï¼Œmd5æ‰¾passå­—ç¬¦\n6.ç¼–ç åŸºç¡€ï¼š(1)åŸ¹æ ¹å¯†ç ï¼šç›´æ¥ä¸€æŠŠæ¢­\n(2)å‡¯æ’’å¯†ç ï¼šé™¤äº†å¯†æ–‡ä¹‹å¤–ï¼Œkeyæ˜¯0-25çš„å…¶ä¸­ä¸€ä¸ª\n7.è“å±æ–‡ä»¶åˆ†æï¼šanalyze -v\n8.å–è¯volaility3ä½¿ç”¨ï¼švol3 -py -xxx\nè¿™é‡Œéœ€è¦æ³¨æ„ ï¼šVolatility3å’ŒVolatility2ç”¨æ³•å·®ä¸å¤šï¼Œä½†ä¸éœ€è¦æŒ‡å®šprofile ï¼Œåªæ˜¯æ’ä»¶è°ƒç”¨æ–¹å¼æ”¹å˜ï¼Œç‰¹å®šçš„æ“ä½œç³»ç»Ÿæœ‰ç‰¹å®šçš„æ’ä»¶\næ–‡ä»¶æ ¼å¼ ctf-flat.vmdk\n\n.vmdk æ–‡ä»¶é€šå¸¸æ˜¯ VMware è™šæ‹Ÿæœºçš„è™šæ‹Ÿç£ç›˜æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è™šæ‹Ÿç¡¬ç›˜ï¼Œè€Œä¸æ˜¯å†…å­˜é•œåƒã€‚\nVolatility æ˜¯ä¸€ä¸ªå†…å­˜å–è¯å·¥å…·ï¼Œå®ƒåˆ†æçš„æ˜¯ RAM çš„å†…å®¹å¿«ç…§ï¼ˆé€šå¸¸æ˜¯ .vmem, .raw, .dmp ç­‰æ ¼å¼ï¼‰ï¼Œè€Œä¸æ˜¯ç¡¬ç›˜ã€‚\n\næ­£ç¡®çš„ Volatility 3 å·¥ä½œæµç¨‹æ—¢ç„¶ imageinfo ä¸å†ä½¿ç”¨ï¼Œé‚£ä¹ˆåœ¨ Volatility 3 ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•è·å–é•œåƒä¿¡æ¯å‘¢ï¼Ÿ\nç­”æ¡ˆæ˜¯ä½¿ç”¨æ–°çš„ã€å¯¹åº”å¹³å°çš„ info æ’ä»¶ã€‚\nç¬¬ 1 æ­¥ï¼šä½¿ç”¨æ­£ç¡®çš„ info æ’ä»¶\nå¦‚æœæ€€ç–‘æ˜¯ Windows ç³»ç»Ÿï¼Œä½¿ç”¨ windows.info.Info æ’ä»¶ï¼š\nBash\nvol3 -f ctf-flat.vmdk windows.info.Info\n\nå¦‚æœæ€€ç–‘æ˜¯ Linux ç³»ç»Ÿï¼Œä½¿ç”¨ linux.info.Info æ’ä»¶ (ä¸è¿‡ Linux é€šå¸¸ç”¨ kallsyms æˆ– banners è¾…åŠ©åˆ¤æ–­)ï¼š\nBash\nvol3 -f ctf-flat.vmdk linux.banners.Banners# æˆ–è€…vol3 -f ctf-flat.vmdk linux.kallsyms.Kallsyms\n\næ‰§è¡Œè¿™äº›å‘½ä»¤åï¼ŒVolatility 3 ä¼šå¼€å§‹åˆ†ææ–‡ä»¶ã€‚å¦‚æœå®ƒèƒ½è¯†åˆ«å‡ºå†…æ ¸ï¼Œå°±ä¼šè‡ªåŠ¨ä¸‹è½½ç¬¦å·è¡¨ï¼ˆé¦–æ¬¡åˆ†ææ—¶ä¼šæ¯”è¾ƒæ…¢ï¼‰ï¼Œç„¶åè¾“å‡ºè¯¦ç»†çš„ç³»ç»Ÿä¿¡æ¯ã€‚\nç¬¬ 2 æ­¥ï¼šè¿è¡Œå…¶ä»–æ’ä»¶ä¸€æ—¦ info æ’ä»¶æˆåŠŸè¿è¡Œï¼Œè¯´æ˜ç¬¦å·è¡¨å·²ç»å°±ä½ï¼Œæ‚¨å°±å¯ä»¥ç›´æ¥è¿è¡Œå…¶ä»–æ’ä»¶äº†ï¼Œæ— éœ€å†æŒ‡å®šä»»ä½• Profileã€‚\nä¾‹å¦‚ï¼ŒæŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼š\nBash\n# å‡è®¾æ˜¯ Windows ç³»ç»Ÿvol3 -f ctf-flat.vmdk windows.pslist.PsList# å‡è®¾æ˜¯ Linux ç³»ç»Ÿvol3 -f ctf-flat.vmdk linux.pslist.PsListä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’ (CTF è§£é¢˜æ€è·¯)åœ¨ CTF æ¯”èµ›ä¸­ï¼Œå†…å­˜å–è¯é¢˜ç›®çš„ç›®æ ‡é€šå¸¸æ˜¯æ‰¾åˆ°éšè—çš„ flagã€æ¶æ„è¿›ç¨‹ã€å¯ç–‘çš„ç½‘ç»œè¿æ¥ã€æ‰§è¡Œè¿‡çš„å‘½ä»¤ã€åŠ å¯†æ–‡ä»¶æˆ–å¯†ç ç­‰ã€‚ä»¥ä¸‹æ˜¯æ ‡å‡†çš„æ’æŸ¥æµç¨‹ï¼Œæ‚¨å¯ä»¥æŒ‰é¡ºåºå°è¯•ï¼š1. æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ (pslist)è¿™æ˜¯å¿…åšçš„ç¬¬äºŒæ­¥ã€‚ç›®çš„æ˜¯å¯»æ‰¾å¼‚å¸¸æˆ–å¯ç–‘çš„è¿›ç¨‹ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒWindows 7 ä¼šæœ‰å¾ˆå¤šç³»ç»Ÿè¿›ç¨‹ï¼Œä½† CTF é¢˜ç›®ä¸­å¾€å¾€ä¼šæ··å…¥ä¸€äº›å‘½åå¥‡æ€ªæˆ–ä¸å¸¸è§çš„è¿›ç¨‹ã€‚Bashvol3 -f mem.raw windows.pslist.PsListå…³æ³¨ç‚¹ï¼šæœ‰æ²¡æœ‰åƒ flag.exe, ctf.exe, nc.exe (Netcat), password.txt è¿™æ ·çš„å¯ç–‘åå­—ï¼Ÿæœ‰æ²¡æœ‰ä¸€äº›ä¸å¸¸è§çš„è¿›ç¨‹åï¼Œå¯ä»¥æ”¾åˆ° Google ä¸Šæœç´¢ä¸€ä¸‹ï¼Ÿæ³¨æ„è¿›ç¨‹çš„å¯åŠ¨æ—¶é—´ï¼Œæ˜¯å¦ä¸ SystemTime (13:08) ç›¸è¿‘ï¼Ÿ2. æŸ¥çœ‹è¿›ç¨‹æ ‘ (pstree)pstree å¯ä»¥å¸®åŠ©ä½ ç†è§£è¿›ç¨‹ä¹‹é—´çš„çˆ¶å­å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ª cmd.exe å¯åŠ¨äº†ä¸€ä¸ªå¯ç–‘ç¨‹åºï¼Œè¿™é‡Œå°±èƒ½çœ‹å¾—å¾ˆæ¸…æ¥šã€‚Bashvol3 -f mem.raw windows.pstree.PsTreeå…³æ³¨ç‚¹ï¼šæ˜¯è°å¯åŠ¨äº†å¯ç–‘è¿›ç¨‹ï¼Ÿæ˜¯ explorer.exe (ç”¨æˆ·æ­£å¸¸å¯åŠ¨) è¿˜æ˜¯ services.exe (ä½œä¸ºæœåŠ¡å¯åŠ¨)ï¼Ÿæœ‰æ²¡æœ‰å­¤å„¿è¿›ç¨‹ï¼ˆæ²¡æœ‰çˆ¶è¿›ç¨‹æˆ–çˆ¶è¿›ç¨‹å·²é€€å‡ºï¼‰ï¼Ÿ3. æŸ¥çœ‹å‘½ä»¤è¡Œå†å² (cmdline / consoles)æ£€æŸ¥æ”»å‡»è€…æˆ–ç”¨æˆ·åœ¨ç»ˆç«¯é‡Œè¾“å…¥äº†ä»€ä¹ˆå‘½ä»¤ï¼Œè¿™é€šå¸¸æ˜¯æ‰¾åˆ° flag çš„ç›´æ¥çº¿ç´¢ã€‚cmdline: æŸ¥çœ‹è¿›ç¨‹å¯åŠ¨æ—¶çš„å®Œæ•´å‘½ä»¤è¡Œå‚æ•°ã€‚Bashvol3 -f mem.raw windows.cmdline.CmdLineå…³æ³¨ç‚¹ï¼šæœ‰äº›ç¨‹åºä¼šå°† flag æˆ–å¯†ç ä½œä¸ºå¯åŠ¨å‚æ•°ï¼Œæ¯”å¦‚ cmd.exe /c &quot;echo flag&#123;...&#125;&quot;ã€‚consoles: æŸ¥çœ‹æ§åˆ¶å°ç¨‹åºçš„å±å¹•ç¼“å†²åŒºå†…å®¹ï¼Œå¯èƒ½ä¼šç›´æ¥æ˜¾ç¤ºå‡ºå‘½ä»¤çš„è¾“å‡ºç»“æœã€‚Bashvol3 -f mem.raw windows.consoles.Consoleså…³æ³¨ç‚¹ï¼šå¦‚æœæ”»å‡»è€…è¿è¡Œäº† type flag.txt è¿™æ ·çš„å‘½ä»¤ï¼Œå†…å®¹å¯èƒ½å°±ç•™åœ¨è¿™é‡Œã€‚4. æŸ¥çœ‹ç½‘ç»œè¿æ¥ (netscan)æ£€æŸ¥å½“æ—¶æ˜¯å¦å­˜åœ¨å¯ç–‘çš„ç½‘ç»œæ´»åŠ¨ã€‚Bashvol3 -f mem.raw windows.netscan.NetScanå…³æ³¨ç‚¹ï¼šæœ‰æ²¡æœ‰è¿æ¥åˆ°å¥‡æ€ªçš„ IP åœ°å€æˆ–ç«¯å£ï¼Ÿæœ‰æ²¡æœ‰å¤„äº LISTENING çŠ¶æ€çš„å¯ç–‘ç«¯å£ï¼Ÿï¼ˆå¯èƒ½æ˜¯åé—¨ï¼‰å“ªä¸ªè¿›ç¨‹ (Owner) å»ºç«‹äº†è¿™äº›è¿æ¥ï¼Ÿ5. æ‰«ææ–‡ä»¶ (filescan) å’Œè½¬å‚¨æ–‡ä»¶ (dumpfiles)å¦‚æœæ€€ç–‘æœ‰åŒ…å« flag çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ flag.txtï¼Œå¯ä»¥å…ˆæ‰«æå†…å­˜ä¸­ç¼“å­˜çš„æ–‡ä»¶å¯¹è±¡ã€‚filescan: æ‰«æå†…å­˜ä¸­çš„æ–‡ä»¶å¯¹è±¡ã€‚Bashvol3 -f mem.raw windows.filescan.FileScanå…³æ³¨ç‚¹ï¼šç”¨ grep è¿‡æ»¤ä½ æ„Ÿå…´è¶£çš„æ–‡ä»¶åï¼Œæ¯”å¦‚ flag æˆ– .txtã€‚Bash# ä½¿ç”¨ grep è¿‡æ»¤ï¼Œ-i è¡¨ç¤ºå¿½ç•¥å¤§å°å†™vol3 -f mem.raw windows.filescan.FileScan | grep -i &quot;flag&quot;vol3 -f mem.raw windows.filescan.FileScan | grep -i &quot;\\.txt&quot;vol3 -f mem.raw windows.filescan.FileScan | grep -i &quot;password&quot;dumpfiles: å¦‚æœ filescan æ‰¾åˆ°äº†å¯ç–‘æ–‡ä»¶ï¼Œè®°ä¸‹å®ƒçš„ç‰©ç†åœ°å€ (ç¬¬ä¸€åˆ— Offset (P))ï¼Œç„¶åç”¨ dumpfiles æŠŠå®ƒä»å†…å­˜é‡Œæå–å‡ºæ¥ã€‚Bash# å‡è®¾ä½ æ‰¾åˆ°çš„æ–‡ä»¶ç‰©ç†åœ°å€æ˜¯ 0x12345678vol3 -f mem.raw windows.dumpfiles.DumpFiles --physaddr 0x12345678æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œä½ å¯ä»¥ç”¨ cat æˆ–æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æŸ¥çœ‹ã€‚6. æ‰«æå¯ç–‘ä»£ç /æ³¨å…¥ (malfind)malfind æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ’ä»¶ï¼Œç”¨äºå¯»æ‰¾éšè—çš„æˆ–è¢«æ³¨å…¥çš„ä»£ç ï¼Œå¸¸ç”¨äºæ£€æµ‹æ¶æ„è½¯ä»¶ã€‚Bashvol3 -f mem.raw windows.malfind.Malfindå…³æ³¨ç‚¹ï¼šå®ƒä¼šæ ‡è®°å‡ºå…·æœ‰ Read-Write-Execute (RWX) æƒé™çš„å†…å­˜é¡µï¼Œè¿™é€šå¸¸æ˜¯å¯ç–‘ä»£ç çš„æ ‡å¿—ã€‚å®ƒè¿˜ä¼šå°è¯•åæ±‡ç¼–è¿™äº›å†…å­˜åŒºåŸŸçš„å¼€å¤´ï¼Œä½ å¯èƒ½ä¼šç›´æ¥çœ‹åˆ°ä¸€äº›å­—ç¬¦ä¸²æˆ–ä»£ç é€»è¾‘ã€‚å¦‚æœ malfind æœ‰å‘ç°ï¼Œè®°ä¸‹å¯¹åº”çš„è¿›ç¨‹ PID å’Œå†…å­˜åœ°å€ï¼Œå¯ä»¥è¿›ä¸€æ­¥ä½¿ç”¨ dumpfiles æå–è¿™éƒ¨åˆ†å†…å­˜è¿›è¡Œåˆ†æã€‚\n\néå¸¸å¥½ï¼pslist çš„ç»“æœç»™äº†æˆ‘ä»¬æå…¶é‡è¦çš„çº¿ç´¢ã€‚è®©æˆ‘ä»¬åƒä¾¦æ¢ä¸€æ ·åˆ†æè¿™ä»½è¿›ç¨‹åˆ—è¡¨ã€‚\nå…³é”®å‘ç°åˆ†æ\nDumpIt.exe (PID 2864)\nè¿™æ˜¯æœ€æœ€æœ€å¯ç–‘çš„è¿›ç¨‹ï¼\nDumpIt.exe æ˜¯ä¸€ä¸ªéå¸¸çŸ¥åçš„å†…å­˜è·å–å·¥å…·ï¼ˆç±»ä¼¼äº FTK Imagerã€WinPmemï¼‰ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯åˆ›å»ºæˆ‘ä»¬ç°åœ¨æ­£åœ¨åˆ†æçš„è¿™ä¸ª mem.raw æ–‡ä»¶ã€‚\nå®ƒçš„å‡ºç°å‡ ä¹å¯ä»¥è‚¯å®šï¼Œè¿™æ¬¡å†…å­˜è½¬å‚¨æ˜¯å‡ºé¢˜äººæ•…æ„åœ¨æŸä¸ªç‰¹å®šæ—¶åˆ»è¿›è¡Œçš„ã€‚\nåˆ›å»ºæ—¶é—´: 2021-05-20 13:08:32 UTCã€‚è¿™ä¸æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ SystemTime (13:08:33) å®Œå…¨å»åˆã€‚è¿™è¯´æ˜ï¼Œåœ¨ DumpIt.exe è¿è¡Œåå‡ ä¹ç«‹åˆ»ï¼Œå†…å­˜å°±è¢« Dump ä¸‹æ¥äº†ã€‚\n\n\ncmd.exe (PID 2624)\nè¿™æ˜¯ç¬¬äºŒé‡è¦çš„çº¿ç´¢ï¼\nå®ƒçš„åˆ›å»ºæ—¶é—´æ˜¯ 2021-05-20 13:04:35 UTCï¼Œæ¯” DumpIt.exe æ—©äº†å¤§çº¦ 4 åˆ†é’Ÿã€‚\nå®ƒçš„çˆ¶è¿›ç¨‹æ˜¯ explorer.exe (PID 1700)ï¼Œè¯´æ˜è¿™æ˜¯ç”¨æˆ·æ‰‹åŠ¨æ‰“å¼€çš„ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ã€‚\nä¸€ä¸ªåœ¨ dump å‰å‡ åˆ†é’Ÿæ‰“å¼€ï¼Œå¹¶ä¸”åœ¨ dump æ—¶ä»ç„¶åœ¨è¿è¡Œçš„ cmd.exeï¼Œææœ‰å¯èƒ½æ˜¯æ”»å‡»è€…&#x2F;å‡ºé¢˜äººè¿›è¡Œæ“ä½œçš„çª—å£ã€‚è¿™é‡Œé¢ä¸€å®šæœ‰ç§˜å¯†ï¼\n\n\nconhost.exe (PID 1588 å’Œ 2824)\nconhost.exe æ˜¯ Windows 7 çš„æ§åˆ¶å°çª—å£ä¸»æœºè¿›ç¨‹ã€‚æ¯ä¸ª cmd.exe éƒ½ä¼šæœ‰ä¸€ä¸ªé…å¯¹çš„ conhost.exeã€‚\ncmd.exe (PID 2624) é…å¯¹çš„æ˜¯ conhost.exe (PID 1588)ã€‚\nDumpIt.exe (PID 2864) é…å¯¹çš„æ˜¯ conhost.exe (PID 2824)ã€‚è¿™è¯´æ˜ DumpIt.exe å¯èƒ½ä¹Ÿæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ã€‚\n\n\n\næ ¸å¿ƒæ¨è®ºï¼š å‡ºé¢˜äººå¾ˆå¯èƒ½å…ˆæ‰“å¼€äº†ä¸€ä¸ª cmd.exe çª—å£ï¼ˆPID 2624ï¼‰ï¼Œåœ¨é‡Œé¢æ‰§è¡Œäº†ä¸€äº›æ“ä½œï¼Œæœ€åè¿è¡Œäº† DumpIt.exe æ¥â€œå›ºå®šè¯æ®â€ï¼Œç„¶åæŠŠç”Ÿæˆçš„å†…å­˜é•œåƒç»™äº†æˆ‘ä»¬ã€‚\næˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯å¤ç°è¿™ä¸ª cmd.exe çª—å£é‡Œå‘ç”Ÿçš„ä¸€åˆ‡ï¼\n\nä¸‹ä¸€æ­¥ï¼šæ·±æŒ– cmd.exe çš„ç§˜å¯†ç°åœ¨ï¼Œæˆ‘ä»¬çš„æ‰€æœ‰æ³¨æ„åŠ›éƒ½åº”è¯¥é›†ä¸­åœ¨ PID ä¸º 2624 çš„ cmd.exe è¿›ç¨‹ä¸Šã€‚\nè¡ŒåŠ¨ 1ï¼šæ£€æŸ¥å‘½ä»¤è¡Œ (cmdline)é¦–å…ˆï¼Œçœ‹çœ‹è¿™ä¸ª cmd.exe æ˜¯æ€ä¹ˆå¯åŠ¨çš„ï¼Œæœ‰æ²¡æœ‰å¥‡æ€ªçš„å‚æ•°ã€‚\nBash\nvol3 -f mem.raw windows.cmdline.CmdLine\n\né¢„æœŸç»“æœï¼š\n\nä½ å¯èƒ½ä¼šçœ‹åˆ°å¾ˆå¤šè¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤ã€‚æ‰¾åˆ° PID ä¸º 2624 çš„é‚£ä¸€è¡Œã€‚\nå®ƒå¾ˆå¯èƒ½å°±æ˜¯ç®€å•çš„ C:\\Windows\\system32\\cmd.exeï¼Œä½†ä¸‡ä¸€æœ‰ /c æˆ– /k ä¹‹ç±»çš„å‚æ•°ï¼Œå°±å€¼å¾—ç‰¹åˆ«æ³¨æ„ã€‚\n\nè¡ŒåŠ¨ 2ï¼šæ£€æŸ¥æ§åˆ¶å°å†…å®¹ (consoles) - ã€æœ€å…³é”®çš„ä¸€æ­¥ã€‘è¿™æ˜¯æœ€æœ‰å¯èƒ½ç›´æ¥æ‰¾åˆ° flag çš„ä¸€æ­¥ï¼è¿™ä¸ªæ’ä»¶ä¼šå°è¯•æ¢å¤ cmd.exe çª—å£çš„å±å¹•ç¼“å†²åŒºï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·èƒ½çœ‹åˆ°çš„æ‰€æœ‰æ–‡å­—å†…å®¹ï¼ŒåŒ…æ‹¬è¾“å…¥çš„å‘½ä»¤å’Œå‘½ä»¤çš„è¾“å‡ºã€‚\nBash\nvol3 -f mem.raw windows.consoles.Consoles\n\nä»”ç»†æ£€æŸ¥è¾“å‡ºï¼\n\nå¯»æ‰¾ PID ä¸º 2624 (cmd.exe) æˆ– 1588 (conhost.exe) çš„éƒ¨åˆ†ã€‚\n\né‡Œé¢å¯èƒ½ä¼šæœ‰ç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼š\ntext\nC:\\Users\\Administrator&gt; dir...C:\\Users\\Administrator&gt; type flag.txtflag&#123;this_is_a_very_ez_flag&#125;C:\\Users\\Administrator&gt; C:\\Users\\Administrator\\Desktop\\DumpIt.exe...\n\nä»»ä½• echo, type, findstr ç­‰å‘½ä»¤çš„è¾“å‡ºéƒ½æ˜¯é‡ç‚¹å…³æ³¨å¯¹è±¡ã€‚\n\nå³ä½¿æ²¡æœ‰ flagï¼Œä¹Ÿå¯èƒ½ä¼šæœ‰å…¶ä»–æç¤ºï¼Œæ¯”å¦‚ä¸€ä¸ªåŠ å¯†æ–‡ä»¶çš„å¯†ç ï¼Œæˆ–è€…ä¸€ä¸ªå¥‡æ€ªçš„æ–‡ä»¶åã€‚\n\n\nè¡ŒåŠ¨ 3ï¼šå¦‚æœ consoles æ²¡æœ‰å‘ç°ï¼Œè½¬è€Œå¯»æ‰¾æ–‡ä»¶å¦‚æœ consoles é‡Œç©ºç©ºå¦‚ä¹Ÿï¼ˆå¯èƒ½æ€§ä¸å¤§ï¼Œä½†ä¹Ÿæœ‰å¯èƒ½ï¼‰ï¼Œé‚£ä¹ˆå‡ºé¢˜äººå¯èƒ½æŠŠ flag æ”¾åœ¨äº†æ–‡ä»¶é‡Œã€‚\nè¿™æ—¶ï¼Œæˆ‘ä»¬å†å›åˆ°ä¹‹å‰çš„æ–‡ä»¶æ‰«æè·¯çº¿ï¼š\nBash\n# -i å¿½ç•¥å¤§å°å†™, -E ä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥åŒæ—¶åŒ¹é…å¤šä¸ªå…³é”®è¯vol3 -f mem.raw windows.filescan.FileScan | grep -iE &quot;flag|password|key|secret&quot;\n\nå¦‚æœæ‰¾åˆ°äº†å¯ç–‘æ–‡ä»¶ï¼ˆæ¯”å¦‚ flag.txtï¼‰ï¼Œè®°ä¸‹å®ƒçš„ç‰©ç†åœ°å€ï¼ˆç¬¬ä¸€åˆ— Offsetï¼‰ï¼Œç„¶åç”¨ dumpfiles æŠŠå®ƒ dump å‡ºæ¥ã€‚\nBash\n# å‡è®¾æ‰¾åˆ°çš„ flag.txt ç‰©ç†åœ°å€æ˜¯ 0xdeadbeefvol3 -f mem.raw windows.dumpfiles.DumpFiles --physaddr 0xdeadbeef\n\n9.å‹ç¼©åŒ…å…¨è§£å‹è„šæœ¬ï¼šimport osimport shutilimport zipfileimport tarfileimport gzipimport bz2import lzmaimport py7zrimport time# --- é…ç½® ---START_ARCHIVE = &#x27;layer_1000.7z&#x27;WORKING_DIR = &#x27;temp_extraction_folder&#x27;FINAL_DIR = &#x27;final_content&#x27;# ----------------def is_archive(filename):    &quot;&quot;&quot;æ ¹æ®æ–‡ä»¶ååç¼€åˆ¤æ–­æ˜¯å¦æ˜¯æ”¯æŒçš„å‹ç¼©æ–‡ä»¶ç±»å‹ï¼ˆæ›´å¼ºå¤§çš„ç‰ˆæœ¬ï¼‰&quot;&quot;&quot;    fn_lower = filename.lower()    # æ ‡å‡†çš„ä»¥ç‚¹å¼€å¤´çš„æ‰©å±•å    supported_extensions = [        &#x27;.7z&#x27;, &#x27;.zip&#x27;, &#x27;.tar&#x27;, &#x27;.gz&#x27;, &#x27;.tgz&#x27;,        &#x27;.bz2&#x27;, &#x27;.tbz2&#x27;, &#x27;.xz&#x27;, &#x27;.txz&#x27;    ]    for ext in supported_extensions:        if fn_lower.endswith(ext):            return True    # &lt;-- ä¿®æ”¹: å¢åŠ å¯¹ &#x27;tar_gz&#x27; è¿™ç±»éæ ‡å‡†åç¼€çš„æ£€æŸ¥    if fn_lower.endswith((&#x27;tar_gz&#x27;, &#x27;tar_bz2&#x27;, &#x27;tar_xz&#x27;)):        return True    return Falsedef decompress_once(file_path, destination_dir):    &quot;&quot;&quot;    å¯¹å•ä¸ªæ–‡ä»¶è¿›è¡Œä¸€æ¬¡è§£å‹æ“ä½œ    è¿”å›æ–°è§£å‹å‡ºçš„æ–‡ä»¶ååˆ—è¡¨    &quot;&quot;&quot;    print(f&quot;-&gt; æ­£åœ¨è§£å‹: &#123;os.path.basename(file_path)&#125;&quot;)    before_files = set(os.listdir(destination_dir))    try:        filename_lower = file_path.lower()        # &lt;-- ä¿®æ”¹: å°† &#x27;tar_gz&#x27; ç­‰éæ ‡å‡†åç§°åŠ å…¥ tarfile çš„å¤„ç†é€»è¾‘ä¸­        # ä¼˜å…ˆå¤„ç† tar ç³»åˆ—å‹ç¼©åŒ…ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½åŒ…å« .gz, .bz2 ç­‰åç¼€        if filename_lower.endswith(                (&#x27;.tar&#x27;, &#x27;.tar.gz&#x27;, &#x27;.tgz&#x27;, &#x27;.tar.bz2&#x27;, &#x27;.tbz2&#x27;, &#x27;.tar.xz&#x27;, &#x27;.txz&#x27;, &#x27;tar_gz&#x27;, &#x27;tar_bz2&#x27;, &#x27;tar_xz&#x27;)):            # &#x27;r:*&#x27; æ¨¡å¼å¯ä»¥è‡ªåŠ¨æ£€æµ‹å‹ç¼©ç±»å‹ (gz, bz2, xz)            with tarfile.open(file_path, &#x27;r:*&#x27;) as t:                t.extractall(path=destination_dir)        elif filename_lower.endswith(&#x27;.7z&#x27;):            with py7zr.SevenZipFile(file_path, mode=&#x27;r&#x27;) as z:                z.extractall(path=destination_dir)        elif filename_lower.endswith(&#x27;.zip&#x27;):            with zipfile.ZipFile(file_path, &#x27;r&#x27;) as z:                z.extractall(path=destination_dir)        elif filename_lower.endswith(&#x27;.gz&#x27;):            output_path = os.path.join(destination_dir, os.path.basename(file_path)[:-3])            with gzip.open(file_path, &#x27;rb&#x27;) as f_in:                with open(output_path, &#x27;wb&#x27;) as f_out:                    shutil.copyfileobj(f_in, f_out)        elif filename_lower.endswith(&#x27;.bz2&#x27;):            output_path = os.path.join(destination_dir, os.path.basename(file_path)[:-4])            with bz2.open(file_path, &#x27;rb&#x27;) as f_in:                with open(output_path, &#x27;wb&#x27;) as f_out:                    shutil.copyfileobj(f_in, f_out)        elif filename_lower.endswith(&#x27;.xz&#x27;):            output_path = os.path.join(destination_dir, os.path.basename(file_path)[:-3])            with lzma.open(file_path, &#x27;rb&#x27;) as f_in:                with open(output_path, &#x27;wb&#x27;) as f_out:                    shutil.copyfileobj(f_in, f_out)        else:            print(f&quot;ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹: &#123;file_path&#125;&quot;)            return []    except Exception as e:        print(f&quot;è§£å‹ &#123;os.path.basename(file_path)&#125; æ—¶å‘ç”Ÿé”™è¯¯: &#123;e&#125;&quot;)        # å°è¯•ç»§ç»­ï¼Œæ¯”å¦‚ tarfile å¯èƒ½ä¼šå› ä¸ºæ–‡ä»¶ä¸æ˜¯ tar æ ¼å¼è€ŒæŠ¥é”™        return None    after_files = set(os.listdir(destination_dir))    new_files = after_files - before_files    return [os.path.join(destination_dir, f) for f in new_files]def main():    &quot;&quot;&quot;ä¸»æ‰§è¡Œå‡½æ•°&quot;&quot;&quot;    start_time = time.time()    if not os.path.exists(START_ARCHIVE):        print(f&quot;é”™è¯¯ï¼šåˆå§‹å‹ç¼©åŒ… &#x27;&#123;START_ARCHIVE&#125;&#x27; ä¸å­˜åœ¨ï¼&quot;)        return    if os.path.exists(WORKING_DIR):        shutil.rmtree(WORKING_DIR)    os.makedirs(WORKING_DIR)    if os.path.exists(FINAL_DIR):        shutil.rmtree(FINAL_DIR)    os.makedirs(FINAL_DIR)    current_file = os.path.join(WORKING_DIR, os.path.basename(START_ARCHIVE))    shutil.copy(START_ARCHIVE, current_file)    layer_count = 0    while current_file and is_archive(current_file):        layer_count += 1        print(f&quot;\\n--- ç¬¬ &#123;layer_count&#125; å±‚ ---&quot;)        new_files = decompress_once(current_file, WORKING_DIR)        if new_files is None:            print(&quot;è§£å‹è¿‡ç¨‹å‡ºé”™ï¼Œç¨‹åºç»ˆæ­¢ã€‚&quot;)            break        old_file_to_remove = current_file        if not new_files:            print(&quot;è§£å‹åæœªäº§ç”Ÿæ–°æ–‡ä»¶ï¼Œå¯èƒ½å·²æ˜¯æœ€åä¸€å±‚ã€‚&quot;)            current_file = None  # ç»ˆæ­¢å¾ªç¯        elif len(new_files) == 1:            current_file = new_files[0]        else:            print(f&quot;è­¦å‘Šï¼šè§£å‹åå¾—åˆ° &#123;len(new_files)&#125; ä¸ªæ–‡ä»¶ã€‚å°†è‡ªåŠ¨å¯»æ‰¾ä¸‹ä¸€ä¸ªå‹ç¼©åŒ…ã€‚&quot;)            next_archive = None            for f in new_files:                if is_archive(f):                    next_archive = f                    print(f&quot;æ‰¾åˆ°ä¸‹ä¸€ä¸ªç›®æ ‡: &#123;os.path.basename(f)&#125;&quot;)                    break            if not next_archive:                print(&quot;åœ¨è§£å‹å‡ºçš„å¤šä¸ªæ–‡ä»¶ä¸­æœªæ‰¾åˆ°ä¸‹ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç¨‹åºç»ˆæ­¢ã€‚&quot;)            current_file = next_archive        try:            if os.path.exists(old_file_to_remove):                os.remove(old_file_to_remove)                print(f&quot;&lt;- å·²æ¸…ç†: &#123;os.path.basename(old_file_to_remove)&#125;&quot;)        except OSError as e:            print(f&quot;æ¸…ç†æ–‡ä»¶å¤±è´¥: &#123;e&#125;&quot;)    # å¾ªç¯ç»“æŸï¼Œå¤„ç†æœ€ç»ˆæ–‡ä»¶    final_file_path = current_file if current_file else old_file_to_remove    if os.path.exists(final_file_path):        print(&quot;\\n==========================================&quot;)        print(&quot;ğŸ‰ è§£å‹å®Œæˆï¼å·²æ‰¾åˆ°æœ€åº•å±‚æ–‡ä»¶ã€‚&quot;)        final_filename = os.path.basename(final_file_path)        destination_path = os.path.join(FINAL_DIR, final_filename)        shutil.move(final_file_path, destination_path)        print(f&quot;æœ€ç»ˆæ–‡ä»¶ &#x27;&#123;final_filename&#125;&#x27; å·²ç§»åŠ¨åˆ° &#x27;&#123;FINAL_DIR&#125;&#x27; æ–‡ä»¶å¤¹ä¸­ã€‚&quot;)        try:            with open(destination_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:                content = f.read(200)                print(&quot;\\næ–‡ä»¶å†…å®¹é¢„è§ˆ:&quot;)                print(&quot;--------------------&quot;)                print(content)                print(&quot;--------------------&quot;)                if &quot;flag&quot; in content.lower() or &quot;&#123;&quot; in content:                    print(&quot;æç¤ºï¼šåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°äº† &#x27;flag&#x27; æˆ– &#x27;&#123;&#x27; ç­‰å…³é”®è¯ï¼&quot;)                    if &quot;flag&#123;I_lOve_Y0u&#125;&quot; in content:                        print(&quot;\\n&gt;&gt;&gt; æ­å–œï¼Flagæ‰¾åˆ°äº†ï¼&lt;&lt;&lt;&quot;)        except Exception:            print(&quot;æ— æ³•ä»¥æ–‡æœ¬æ–¹å¼è¯»å–æœ€ç»ˆæ–‡ä»¶ï¼Œå®ƒå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&quot;)    else:        print(&quot;\\næœªèƒ½æ‰¾åˆ°æœ€ç»ˆæ–‡ä»¶ã€‚&quot;)    shutil.rmtree(WORKING_DIR)    print(f&quot;ä¸´æ—¶å·¥ä½œç›®å½• &#x27;&#123;WORKING_DIR&#125;&#x27; å·²è¢«æ¸…ç†ã€‚&quot;)    end_time = time.time()    print(f&quot;\\næ€»è€—æ—¶: &#123;end_time - start_time:.2f&#125; ç§’&quot;)if __name__ == &#x27;__main__&#x27;:    main()\n\n\n","tags":["ctf","flag"]},{"title":"misc","url":"/2025/12/18/misc/","content":""}]